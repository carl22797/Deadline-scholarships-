<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
async function handleSubmitForm(event) {
    event.preventDefault();
    const form = document.getElementById('scholarshipForm');
    const postSubmissionActionsDiv = document.getElementById('postSubmissionActions');
    const fullNameInput = document.getElementById('fullName');
    const applicantName = fullNameInput.value.trim();

    if (!form.checkValidity()) return;

    // Collect only the main text fields from your original form
    const fields = [
        'fullName', 'dob', 'gender', 'nationality', 'countryRes', 'email', 'phone',
        'lastInstitution', 'degreeAwarded', 'major', 'gpa', 'englishProficiency',
        'programInterest', 'universityInterest', 'reasonForScholarship', 'futureGoals',
        'desiredAmount', 'extracurricular', 'workExperience'
    ];

    const data = {};
    fields.forEach(id => {
        const el = document.getElementById(id);
        if (el) {
            if (el.type === "radio") {
                const selected = document.querySelector(`input[name="${el.name}"]:checked`);
                data[el.name] = selected ? selected.value : '';
            } else {
                data[id] = el.value;
            }
        }
    });

    // --- Generate PDF ---
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    let y = 10;
    doc.setFontSize(12);
    doc.text("Scholarship Application", 105, y, { align: "center" });
    y += 10;
    for (let key in data) {
        doc.text(`${key}: ${data[key]}`, 10, y);
        y += 7;
        if (y > 280) { // add new page if too long
            doc.addPage();
            y = 10;
        }
    }
    doc.save(`${applicantName || 'Applicant'}_Application.pdf`);

    // --- Show post-submission message ---
    alert(`
Dear ${applicantName || 'Applicant'},

Your scholarship application has been successfully received!

Important: A refundable registration fee is required to process your application. You will receive separate communication with detailed payment instructions.

Thank you!
    `);

    form.style.display = 'none';
    postSubmissionActionsDiv.style.display = 'block';
    postSubmissionActionsDiv.scrollIntoView({ behavior: 'smooth' });
}
                </script>
